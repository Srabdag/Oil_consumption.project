/*
Question: Year-over-Year Change 
- Identify specific years to change from and to
- Identify the countries and regions you want the changes to happen
- Focus on multiple years.
*/


-- For year to year:
SELECT 
    country_continent,
    ((year_2019 - year_2018) / year_2018) * 100 AS yoy_change_2019
FROM
    oil_consumption;


-- Multiple years 
SELECT 
    country_continent,
    ((year_2019 - year_2018) / year_2018) * 100 AS yoy_change_2019
FROM
    oil_consumption;
SELECT 
    country_continent,
    ((year_1966 - year_1965) / year_1965) * 100 AS yoy_change_1966,
    ((year_1967 - year_1966) / year_1966) * 100 AS yoy_change_1967,
    ((year_1968 - year_1967) / year_1967) * 100 AS yoy_change_1968,
    ((year_1969 - year_1968) / year_1968) * 100 AS yoy_change_1969,
    ((year_1970 - year_1969) / year_1969) * 100 AS yoy_change_1970,
    ((year_1971 - year_1970) / year_1970) * 100 AS yoy_change_1971,
    ((year_1972 - year_1971) / year_1971) * 100 AS yoy_change_1972,
    ((year_1973 - year_1972) / year_1972) * 100 AS yoy_change_1973,
    ((year_1974 - year_1973) / year_1973) * 100 AS yoy_change_1974,
    ((year_1975 - year_1974) / year_1974) * 100 AS yoy_change_1975
FROM
    oil_consumption;





-- query answers:
-- Year to year
'Africa','-0.18737693685023404'
'Africa (EI)','-0.18737693685023404'
'Algeria','4.023690667420594'
'Argentina','-9.24726528485254'
'Asia','0.8395472837503453'
'Asia Pacific (EI)','1.69846363282771'
'Australia','-0.959738991149619'
'Austria','2.879657077323143'
'Belgium','-6.344960957073666'
'Brazil','-0.430432059940252'
'Bulgaria','4.874457716248125'
'CIS (EI)','1.1681066620882732'
'Canada','-0.3182082237632112'
'Central America (EI)','8.499861397512412'
'Chile','-0.40101286804096103'
'China','4.818463199297057'
'Colombia','-0.10997293744290844'
'Cyprus','-0.5154554221511604'
'Czechia','1.2829426044504701'
'Denmark','0.26530578688223516'
'Eastern Africa (EI)','-0.1980812389030319'
'Ecuador','-3.0964926543567493'
'Egypt','-5.617241797995469'
'Europe','0.03447507878927812'
'Europe (EI)','-0.46315904881501596'
'European Union (27)','-0.2989398523829358'
'Finland','-0.7460528823415271'
'France','-0.824618735033634'
'Germany','1.010342788928202'
'Greece','3.0410493549184485'
'High-income countries','-1.2146551044640486'
'Hong Kong','-6.540488685871535'
'Hungary','1.0752549448557813'
'Iceland','-15.330268264359868'
'India','3.2328861374705498'
'Indonesia','-2.5391998832269853'
'Iran','4.947754409436956'
'Iraq','-1.8298087142501793'
'Ireland','-0.011259339672962653'
'Israel','1.010812167979527'
'Italy','-2.913224891661697'
'Japan','-2.5108238014530975'
'Kuwait','-4.637799925056534'
'Lower-middle-income countries','1.8245532427897857'
'Luxembourg','1.088961938755974'
'Malaysia','8.671147656184187'
'Mexico','-4.642331710445982'
'Middle Africa (EI)','6.88492773088218'
'Middle East (EI)','-2.3478146839690104'
'Morocco','1.4876862236785346'
'Netherlands','-2.4175712890402328'
'New Zealand','2.512855002895627'
'Non-OECD (EI)','1.0293109189439908'
'North America','-0.6732922100475214'
'North America (EI)','-0.5357073696711189'
'Norway','-4.5040589812648335'
'OECD (EI)','-0.7515730376934'
'Oceania','-0.47270362124478504'
'Oman','-2.183424001178825'
'Pakistan','-11.545643349398315'
'Peru','3.0312419282948326'
'Philippines','2.089599893454728'
'Poland','1.9328628561651215'
'Portugal','3.3617292342000886'
'Qatar','9.05505450218925'
'Romania','4.584031413635342'
'Singapore','-2.8633317960072935'
'Slovakia','-5.364361678520481'
'South Africa','-0.8532526445982477'
'South America','-1.4451319336121153'
'South Korea','-1.0083172721687648'
'South and Central America (EI)','-1.108607245939387'
'Spain','0.267390794979529'
'Sri Lanka','4.2196826043569935'
'Sweden','1.8207856690652546'
'Switzerland','2.6263108272048696'
'Taiwan','-5.648212925087788'
'Thailand','1.1497478080333867'
'Trinidad and Tobago','0.8830743192770444'
'Turkey','-0.4921277340118097'
'United Arab Emirates','-2.3608516036944263'
'United Kingdom','-2.006221284294289'
'United States','-0.15604980006331398'
'Upper-middle-income countries','1.9040409556939535'
'Venezuela','-1.2474692022268912'
'Vietnam','2.799962397788251'
'Western Africa (EI)','1.5766941277948345'
'World','0.18224303491984808'

-- Multiple years 
'Africa','8.276384349159411','-0.3391712781751935','5.73470489218203','1.9949396168771962','9.261202583146','9.02894679834155','7.679482460035239','7.650694222539668','3.625754168813205','4.902687812040085'
'Africa (EI)','8.276384349159411','-0.33918207585369603','5.7347163479313785','1.9949396168771962','9.261210117932977','9.02893008474163','7.679491541061226','7.650702054472654','3.625746629708054','4.902705363952055'
'Algeria','31.596066445263798','-6.563874924436573','6.468530564041972','5.645921583656647','14.27653642546763','12.700873348097232','9.771724889110983','9.225765430533905','11.074336758474725','11.183362230132353'
'Argentina','3.1467658663616596','2.4160699572313757','2.085146625818447','3.7784183947827064','-9.602221268145106','6.4882531142760245','-0.44347221646058743','0.6817527377634952','-0.025114516001818868','-5.484558635451875'
'Asia','14.765649348772786','12.91836343659317','11.9557787893768','17.313330987838512','16.1932447992747','9.656932173161099','9.871622211311424','12.615352004609615','-1.1152485959356728','1.6093308559093276'
'Asia Pacific (EI)','16.893836105942437','14.257396269144593','13.173107029261041','18.469333324278843','17.644533298130185','9.451805899266072','9.721111898465319','12.52399469763435','-1.682632978430927','2.025763136039916'
'Australia','7.013416101321389','9.502659572604305','8.915666074030492','2.8059346536590435','10.572481906138245','5.289249932976189','1.7963991896959404','6.7065410604187266','5.978494149348277','-1.0322084964271776'
'Austria','9.941241224010493','6.629510483938586','15.569233518632936','9.902018473434053','10.097773239439377','11.736684053654741','7.955933190379091','8.367943775727419','-10.505509948308337','1.0633192278256687'
'Belgium','2.0139309870943993','10.283625896766003','16.095513674068343','15.375313399811445','9.087340676439753','2.4823666100265345','8.178115464759141','4.9965697393362865','-11.909644307801248','-5.097612401152567'
'Brazil','9.040105427001421','3.196190417022201','20.103041260756132','9.730201753858262','14.304202350727923','13.575094920160724','13.610834467064903','21.144960651543812','10.875556974948664','3.0663494165895044'
'Bulgaria','14.088003628921292','25.76154997622313','18.519142667418123','22.78868268240879','16.170745303295345','9.986749622870757','3.991670347851379','5.444690944610683','3.986976431121753','5.995991638581852'
'CIS (EI)','7.088143742172026','8.954777848051592','6.59805928439145','6.3383891492063125','10.084324503795699','6.015889387623105','8.459790312953526','7.507863822106496','9.853294266914462','4.828018726471433'
'Canada','5.358324401436649','6.7690179667490575','6.456437519136199','4.124770668897917','6.644032470778639','2.6965493446345823','5.295032408371575','9.228277953568234','1.720348229574156','-1.3417890130691006'
'Central America (EI)','3.0083831732100954','3.923855552987246','3.1410593220964502','3.9148972326924367','3.8649680316595387','3.7651252593014433','5.76026958689382','10.119904847646117','5.939767204141115','11.855737801086901'
'Chile','9.579146413999377','4.425532814379103','5.4159669384895155','6.54043644817416','5.606443464777615','10.877634032077093','3.6099341315209412','-3.9528131873146237','-2.594561924523431','-12.328100720108703'
'China','28.464783698258504','-1.2708451573251964','9.372260875918586','34.077091037618665','38.32675406246837','35.99871981411707','15.084632063405614','21.991027455447558','14.998806750526935','10.287755821433525'
'Colombia','19.529356868347776','0.15857863728589414','7.634213503142459','-3.9419974576471195','13.411230102297173','3.602558542255273','18.14105120066245','-8.29949980667062','10.65712368804787','-12.400968202793178'
'Cyprus','14.067239997863354','8.403319427149132','11.058732981545328','18.087707259867067','5.468334402817831','19.284409448346725','12.447068983411352','7.284579720095599','-11.338368997071841','-16.477432281963026'
'Czechia','10.404714139847641','11.276331784040572','10.45174901421527','7.288179930654927','20.200207510453442','10.094966940427188','9.412343597783304','12.426291471036595','2.535376247933756','10.342412730458332'
'Denmark','13.898232566722191','5.760754775641653','8.694612094612554','20.230852556314215','11.233254680537835','-1.2771407068603777','5.800158772017738','-7.536186537785537','-9.464278347443287','-1.1640776907609747'
'Eastern Africa (EI)','4.741430867672709','6.499096881269866','3.196713265083506','10.154116276029058','4.148373956578586','7.827399596953747','1.5561274488236045','5.494360654095119','0.7280426338301661','-3.242486171386314'
'Ecuador','4.407630012008125','7.99777502342876','19.49353420042623','5.818035404701335','14.031584555847655','10.520821159458894','2.803952846162642','11.294885962533986','13.891517208616353','-2.1498859663870054'
'Egypt','7.30547133878396','-18.339090718924968','4.594788498405065','-25.765623838384244','29.41071057296401','3.3654490167711466','14.274964969262044','-6.001444968233614','10.290547628969147','10.542794866158909'
'Europe','8.938587371661589','8.606911325552275','8.938232914082365','9.966374034564176','10.686710080291085','5.121201194663472','7.356936587688395','7.116458248313132','-1.6056631633144562','-1.0780811347666048'
'Europe (EI)','9.767605666324853','8.551787012373154','9.967231435443784','11.359663344282634','10.85412725127831','4.937458156624058','7.025367493236391','7.1554477012457305','-5.864697980153055','-3.4626539899040214'
'European Union (27)','10.209820188312712','8.61078051057436','10.6148834230933','12.35871437708393','11.751468511072979','5.311751301369756','7.308855094803186','7.76510434067337','-5.8885001261020165','-2.2828915751995713'
'Finland','21.30708709488324','4.7736465559563035','13.354043132655416','16.143187401898107','12.447277860332157','3.4974264033579407','6.4229878655200885','11.870670310693741','-12.856361564065658','3.40474970897757'
'France','7.189941839136099','14.882678522023108','8.364229921380248','15.549268604352493','13.60208356938298','8.995335432830482','11.030110166562782','11.478409530664619','-4.982511585460435','-8.603337401153057'
'Germany','11.881837455187785','3.992653211216135','12.101944246255922','12.457086037222577','9.82859854671705','4.1641470054015866','5.563967078682394','6.600869424572096','-9.268815887518752','-2.8706551502118276'
'Greece','9.18894084750227','17.583823867244764','2.35457810376943','6.406886495394414','8.308832965269183','10.471455362755961','15.842949349391741','16.391724594282955','-6.15514030148727','5.951457613517914'
'High-income countries','7.738603993294029','7.032285193207537','8.528580452624606','9.023237666386091','8.947645821613357','4.526228666469248','7.64174371801562','7.393589031500768','-4.523092715056451','-2.844493531505089'
'Hong Kong','9.736115455102233','19.826346943164012','9.217167895038978','18.652995381125713','7.9190330820744865','5.483911366629435','14.005922648316863','3.85029188009103','2.3729502318311573','-5.846483090394246'
'Hungary','9.83243545910167','5.806491655025648','4.802458479341675','11.857077099005313','16.148331546571153','12.666935841373542','8.952672183677324','12.511218159396794','9.477608288100507','12.810832499386343'
'Iceland','7.8164036984811975','-2.9683073936745066','6.774562797983911','-8.29138655424989','2.193832392703758','8.919279818399875','7.144500077269258','15.791317843543732','-6.671488496502474','-6.067678623447852'
'India','11.670141725103408','3.174261635737683','12.051638339371458','20.107372632335757','-0.45513329752976533','7.246200771338014','7.829115770251121','5.555171892838876','-1.955563255048344','2.4120786481785865'
'Indonesia','-3.693171087960609','-3.5234881941404743','5.780941365724402','7.061451225825313','6.1029021953445906','3.6437309697284954','8.148133588146598','19.376687527978593','4.470782116280993','14.687032490977291'
'Iran','9.451846330176563','10.616017123133394','10.349246559493245','9.220096086266818','8.054488701070229','9.636719613208884','11.304122709864492','20.032760671717455','16.231652914515614','17.258043544478745'
'Iraq','7.009216819449973','7.128063363092261','7.355257952283097','7.098125855912454','31.194397221424463','7.178864081558044','21.652032069044406','-2.136883533897134','-1.6051183511449036','-0.11637937969430677'
'Ireland','11.778170540572257','11.963464012040568','11.229153995902593','8.687839471344134','12.219052782240848','10.462907651813557','10.07846738153532','8.366955664172004','-0.9622180793832288','-2.1870598606174827'
'Israel','3.5214556801428416','21.534337334198412','1.2380164188722205','13.294314316078212','7.121131777722796','13.890114740338118','-5.339893247996863','7.719359615745611','0.267878763000527','2.856727472157924'
'Italy','10.2656801228415','10.681102039555054','10.262011677582814','10.149726052415865','13.121931123640348','7.549504950495055','4.982973033781734','5.255586240918486','-2.706727600233812','-6.081043647462419'
'Japan','19.37535737222952','18.439264296864724','13.878122941665689','22.602270974648395','21.144273107883357','7.744846466468442','9.909853667902164','13.028509791754628','-5.2907444175363745','-0.8989689718132864'
'Kuwait','-2.7253267814993603','-2.719389059913318','-2.6884048309990605','-2.674260355807392','-2.6549351777551444','-1.6413267227598296','7.829768177910387','-5.467536218086922','-8.562397205151774','-22.325474812906755'
'Lower-middle-income countries','14.988418991226936','5.327078385550081','10.313454094885975','7.549476287107902','5.869532302032061','5.174674803391347','6.856553027741863','7.9097693055293','0.8310400294464063','8.134840147178885'
'Luxembourg','13.803487523802763','10.44250843553265','10.386676079159455','10.723839974008975','6.0826012521664845','4.106366420379338','5.009482194545795','11.120882621421249','-10.07044715512939','-10.812089846760347'
'Malaysia','15.45234578743628','7.848715579354813','3.006396401734208','8.693138234466769','-6.949833600848189','11.380452231435036','9.42668349420105','6.3888385572686','-0.29714638778919145','4.587439354068947'
'Mexico','4.7888716227613255','7.103106431886901','8.74169659781081','5.682036444477125','7.523629916694348','6.045890263053953','12.603542559985012','7.015753277942663','12.9667049565311','10.345313478825311'
'Middle Africa (EI)','1.6058639425297487','1.9205003070280668','2.9790884391805954','2.8152649552773785','1.4552260461345263','15.813723516186265','4.311134847495094','3.621488481711687','3.2165505695031333','-2.6360329775029645'
'Middle East (EI)','2.5117453316162814','4.399708450065126','2.9972877933589483','4.0153869185902','6.115644955237807','7.200233471364638','6.370080711780083','8.51215914305761','6.290205201176661','-4.281480805915396'
'Morocco','43.02107272973716','9.864887786791684','9.739602234969924','8.247682986655935','4.669320751071428','5.537382721828854','6.39909379652864','19.59839761414725','7.217396278745842','3.5179501183856625'
'Netherlands','8.43949876537887','2.209348492601841','7.864030098177653','9.068137238412351','11.19485393548063','-1.2218455856251034','11.557514915434378','3.206212678631216','-14.2646906347628','-1.3959801249476977'
'New Zealand','10.716031476358259','5.032258171645807','2.7512732594308305','3.8699898410010034','17.540392683312923','3.2905450704615644','7.659479620819602','5.703489497697059','-5.380555143128496','-3.2529109102360385'
'Non-OECD (EI)','7.627502580618793','6.734266570037252','7.358623658996284','7.154571672367561','9.396480639807752','8.015118052233186','8.59779277722706','9.240039906966363','6.50070782808938','3.7199461776415346'
'North America','4.920666830151392','4.172830753516128','6.601939263537067','4.886130149288053','4.945839315265156','3.4444260767525594','7.81302447013279','6.31881230467756','-2.891265935926834','-1.9707211445632842'
'North America (EI)','4.971963487370957','4.1692414911642075','6.741023958225001','4.949406420289613','4.681254965565698','3.486599672122548','7.683714904337345','6.203007846025025','-2.9630182092304818','-1.8627529277355215'
'Norway','12.878716123479075','3.5336378274588514','11.229831819580454','9.926903851628293','12.569886589617962','-1.054156113390165','4.741043824634794','1.6055733815576876','-9.013467012924368','3.5229166057071786'
'OECD (EI)','7.932264610081724','7.038411941913675','8.661307575014776','9.075968059910638','9.013316415322667','4.563899768726496','7.62544240229791','7.416470231949416','-4.317696013126559','-2.444743092205359'
'Oceania','7.5328011732365665','8.85700246737332','8.05662210599804','2.9469390712154175','11.504102844657012','5.007550651888885','2.6092221651131746','6.5606433382375045','4.339526272270845','-1.3227809753122637'
'Oman','25.13906524454832','343.93432818722886','20.504337194881995','42.4297010834376','0.7963825095898122','1553.1049712706067','14.256624857754613','-13.018463993425216','-8.116792276543686','-8.657956751199029'
'Pakistan','2.662938317051302','11.776618067697108','13.894707640854431','-6.211632603666168','-1.0685234818153466','-5.963270113861576','-17.464359383466363','2.493105519841444','7.740267580246487','3.838741376887838'
'Peru','26.101555615096427','0.7322918839567832','0.3236972486955669','-1.5691201168933442','5.078629090491914','-1.1273410081500443','-14.656466494023096','16.502389400096924','17.81640451469489','4.736441414708084'
'Philippines','11.390222657359237','8.822199173301067','18.41508497904681','7.824512298846331','1.3100885445636141','8.294538529320555','5.56383036787497','11.628551982816548','-6.339407675501999','8.474297718864447'
'Poland','4.010523905797075','8.524050374489683','25.12049582812846','9.990266306875927','5.761068868404751','6.0288960342331475','12.237002181068908','10.932960531047941','5.3090472140108735','8.852295980934972'
'Portugal','2.4992931429758833','10.32695530505774','7.278182487016332','4.945863747993302','38.14512262823443','13.46622689966124','8.772466917301575','9.934601368633098','6.589227993824941','4.730111774245837'
'Qatar','-0.12838092944664145','51.36898438203674','29.31728178555722','16.145537206601755','-13.57254467718618','-3.9539575698713443','19.026330035872245','29.818196308325906','36.562233796720264','19.158972193217426'
'Romania','4.234979056110283','13.319036708047157','5.463617249465025','11.481188372979256','8.379540712905577','1.5897620392040956','6.743538915628566','12.49476300524589','-7.923105591038272','13.692994067851098'
'Singapore','14.3057560672658','20.180021896087037','24.259503754728495','-1.6912192837178819','8.578175722519738','-13.214093439190252','25.24867253478772','-5.7799166778800615','-1.4331267980732227','-2.301859570156509'
'Slovakia','10.366479982436577','11.26331742428125','10.507062943621552','7.277070506222129','20.175031320991927','10.12454398401265','9.387647327642568','12.446343468085177','2.5347219351014543','10.317371796998188'
'South Africa','8.658115664925091','8.989721839581119','8.700380457599643','9.93560143005421','8.366143838625613','9.298074931123072','8.996048275220087','10.325808597657147','-2.5570510091052427','6.2413225939095005'
'South America','6.488563654778337','2.4424054668675548','8.14441974360111','4.078072388938386','3.4434190187720706','7.441830831811765','6.682806480075389','8.99269380718642','5.812066064486066','-0.10825985642287496'
'South Korea','49.72538748834347','73.35635734713127','47.84489394795443','35.718932412390934','24.907882778434594','12.941206112235335','4.381603408553988','23.093274466315485','3.297664357232142','13.347600715529726'
'South and Central America (EI)','5.633587585600007','2.9072535746412584','6.612790060612543','3.793481611226778','5.691362584872603','6.087506693626583','7.802470173660622','9.226800493472172','4.295667085461199','-0.7673243244475632'
'Spain','18.30256706640695','21.158337847302562','6.214564653402951','13.849406594378383','14.080153552296027','10.0685819978525','5.441631747484423','20.117824712012087','4.821761209926734','3.9862162057369046'
'Sri Lanka','2.4194211647215815','2.4266444919471435','2.5125087525169683','2.2031261128164528','70.5683151796456','0.6576338927037597','5.209276422242141','6.369229936004508','-20.12732308099207','3.6651873447621157'
'Sweden','13.040054940450341','-0.3374763938289623','13.111402563718134','7.107683389444571','8.812033106544664','-5.960859125859879','2.6427095909036953','2.2189585863435597','-10.182458396193834','-0.2758018629889898'
'Switzerland','6.317210827690017','8.162933893742112','10.91755519998383','8.74475947826881','12.069449163325555','6.11540299671066','2.522299251696209','7.623994651434273','-11.007509015721501','-3.8378318855753233'
'Taiwan','18.298701118214986','18.770384788462202','19.265904770929083','19.7526803700242','20.090831079116555','39.971145285718826','8.217818377127251','27.570967218080426','-10.233560321867543','15.885666914595214'
'Thailand','18.035283929852405','10.989688653579085','31.816454417442237','8.303048033050759','16.41582483112935','11.325006668401787','25.532164955271952','5.859250080067429','1.8041938570445897','8.41638312966493'
'Trinidad and Tobago','0.7015482498504516','4.331300613698923','1.9164529720753085','4.836166018905387','2.5787368592982993','3.335446981404614','62.310076263852274','0.6403530910629507','-1.5320587982391842','-23.54613192628533'
'Turkey','19.356056931735246','17.42292518006387','20.146064933608397','11.251803239327563','5.9489480084813','18.54040793836382','13.358870849373366','21.939277734843518','-2.697878407635873','10.451688795214304'
'United Arab Emirates','6.729765848715032','7.47934849030428','11.676258380720627','11.11816521773287','16.37306862321968','18.00938844557584','31.404379112167017','56.053611094749265','38.530352687447575','61.71510296783636'
'United Kingdom','7.135024124454746','7.467754251747101','5.855908905708437','7.489079624024473','5.898641269055522','0.5291164178191087','6.032958680584201','2.6485130977735345','-7.113018667373157','-12.541518655760028'
'United States','4.938329344699499','3.8261718300255003','6.713132480367863','5.013126241877632','4.396840179789214','3.491755342224493','7.778924384318783','5.870045675879316','-3.974498860982953','-2.3908626720553614'
'Upper-middle-income countries','7.947107708673022','7.138304119134702','7.870899794907252','7.5439837910164425','10.18211508790739','8.779248893754762','9.27589955857118','9.625078859380007','8.972482931976074','5.233864977287974'
'Venezuela','-1.7125474095852486','2.031559788675028','8.929110359330386','-1.2059034768284091','4.617269261725506','0.945068892991533','9.068068443575465','9.791576123877189','0.09671144460186394','6.6588009618150386'
'Vietnam','118.55038491989023','46.458671044238336','2.0149701965655686','20.861548579468906','3.673144079622512','-15.403089750230103','3.5385954370776704','-1.8034806178084166','-38.966605881301575','-4.612880960644013'
'Western Africa (EI)','3.145236801597242','2.604788229905279','3.8703917733635698','8.976704540490662','5.756784605446177','22.84506733369989','5.921611368583116','11.839818168938727','4.505351665342938','9.426091994103555'
'World','7.85496976547424','6.96145721624687','8.332393319136223','8.595195698512986','9.107924209326173','5.418252728921875','7.872089915081879','7.882135247742637','-1.5203378385915143','-0.7208829713205857'
